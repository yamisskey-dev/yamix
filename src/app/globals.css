@tailwind base;
@tailwind components;
@tailwind utilities;

/* DXM Dark Theme (default) */
:root {
  --background: #130E26;
  --foreground: #C2CBE0;
  --accent-purple: #A374FF;
  --accent-pink: #B32DB6;
  --accent-gradient: linear-gradient(135deg, #B32DB6, #966BFF, #4B38A5);
}

/* NGO Light Theme */
[data-theme="light"] {
  --background: #FFF5FC;
  --foreground: #391E60;
  --accent-purple: #966BFF;
  --accent-pink: #FF9DFF;
  --accent-gradient: linear-gradient(172deg, #FF9DFF, #A398FF 45%, #7D66FF);
}

:root:has(.no-doc-scroll) {
  overflow: hidden;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: var(--font-sarasa-gothic), Arial, Helvetica, sans-serif;
}

/* Background with image */
.animated-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  background-image: url('https://angelkawaii.com/wp-content/uploads/2024/01/33.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

.animated-bg::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(19, 14, 38, 0.6);
}

[data-theme="light"] .animated-bg::after {
  background: rgba(255, 245, 252, 0.7);
}

/* Spinner animation */
@keyframes spinner {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin-slow {
  animation: spinner 6s linear infinite;
}

/* Glass effect */
.glass-card {
  @apply backdrop-blur-md bg-white/70 dark:bg-gray-900/70 border border-white/20 dark:border-gray-700/30;
}

/* Chat bubbles with tails */
.chat-bubble {
  max-width: 90%;
  overflow: visible !important;
  border: none !important;
}

/* User bubble (right) */
.chat-user {
  @apply bg-gradient-to-br from-primary to-secondary text-primary-content;
  border-radius: 1rem 1rem 0.25rem 1rem;
}
.chat-end .chat-bubble.chat-user::before {
  background-color: var(--accent-pink) !important;
}

/* Assistant bubbles (left) - shared styles */
.chat-assistant,
.chat-assistant-loading,
.chat-human-response {
  @apply text-base-content;
  border-radius: 1rem 1rem 1rem 0.25rem;
}

/* Assistant bubble */
.chat-assistant,
.chat-assistant-loading {
  background-color: rgba(163, 116, 255, 0.3) !important;
}
.chat-start .chat-bubble.chat-assistant::before,
.chat-start .chat-bubble.chat-assistant-loading::before {
  background-color: rgba(163, 116, 255, 0.3) !important;
}

/* Human response bubble (pink tint) */
.chat-human-response {
  background-color: rgba(179, 45, 182, 0.3) !important;
}
.chat-start .chat-bubble.chat-human-response::before {
  background-color: rgba(179, 45, 182, 0.3) !important;
}

/* Light theme overrides */
[data-theme="light"] .chat-assistant,
[data-theme="light"] .chat-assistant-loading {
  @apply bg-base-200;
}
[data-theme="light"] .chat-start .chat-bubble::before {
  background-color: #FCF9FF !important;
}

/* Typing animation - gradient pulse (Misskey-inspired) */
@keyframes typing-pulse {
  0%, 100% {
    transform: scale(0.8);
    opacity: 0.4;
  }
  50% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes gradient-shift {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.typing-dot-gradient {
  @apply w-2 h-2 rounded-full;
  background: var(--accent-gradient);
  background-size: 200% 200%;
  animation: typing-pulse 1.2s infinite ease-in-out, gradient-shift 3s infinite ease-in-out;
}

.typing-dot-gradient:nth-child(1) {
  animation-delay: 0s, 0s;
}

.typing-dot-gradient:nth-child(2) {
  animation-delay: 0.15s, 0.5s;
}

.typing-dot-gradient:nth-child(3) {
  animation-delay: 0.3s, 1s;
}

/* Legacy typing dot */
.typing-dot {
  @apply w-1.5 h-1.5 rounded-full bg-primary;
  animation: typing-pulse 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) {
  animation-delay: 0s;
}

.typing-dot:nth-child(2) {
  animation-delay: 0.15s;
}

/* Emotion indicator colors */
.emotion-happiness { @apply bg-yellow-400; }
.emotion-sadness { @apply bg-blue-400; }
.emotion-anxiety { @apply bg-purple-400; }
.emotion-anger { @apply bg-red-400; }
.emotion-loneliness { @apply bg-indigo-400; }
.emotion-depression { @apply bg-gray-600; }
.emotion-stress { @apply bg-orange-400; }
.emotion-confusion { @apply bg-teal-400; }
.emotion-hope { @apply bg-green-400; }
.emotion-neutral { @apply bg-gray-400; }

/* Fade in animation */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Slide up animation */
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-up {
  animation: slideUp 0.3s ease-out;
}

/* Scale in animation (for modals) */
@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-scale-in {
  animation: scaleIn 0.2s ease-out;
}

/* Slide in right animation (for toasts) */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-slide-in-right {
  animation: slideInRight 0.3s ease-out;
}

/* Dropdown animation */
@keyframes dropdownIn {
  from {
    opacity: 0;
    transform: translateY(-4px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.animate-dropdown-in {
  animation: dropdownIn 0.15s ease-out;
}

/* Pulse animation for skeletons */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.skeleton {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* Smooth transitions for interactive elements */
.btn {
  transition: background-color 150ms ease-in-out, color 150ms ease-in-out, transform 100ms ease-out, opacity 150ms ease-in-out;
}

.chat-bubble {
  transition: transform 150ms ease-out, opacity 150ms ease-out, box-shadow 200ms ease-out;
}

/* Smooth message entrance - disabled to prevent bounce on re-render */
/* .chat {
  animation: slideUp 0.2s ease-out;
} */

/* Hover effects */
.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

/* GitHub Corner (yamisskey-down style) */
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out;
}

@keyframes octocat-wave {
  0%, 100% { transform: rotate(0); }
  20%, 60% { transform: rotate(-25deg); }
  40%, 80% { transform: rotate(10deg); }
}

@media (max-width: 500px) {
  .github-corner:hover .octo-arm {
    animation: none;
  }
  .github-corner .octo-arm {
    animation: octocat-wave 560ms ease-in-out;
  }
}

/* ============================================
   Accessibility Improvements
   ============================================ */

/* Enhanced focus ring for better visibility */
:focus-visible {
  @apply outline-none ring-2 ring-primary ring-offset-2 ring-offset-base-100;
}

/* Skip link for keyboard users */
.skip-link {
  @apply sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-content focus:rounded-lg;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ============================================
   Mobile UX Improvements
   ============================================ */

/* Ensure minimum tap target size (44px) */
@media (max-width: 768px) {
  .btn-xs {
    min-height: 2.5rem;
    min-width: 2.5rem;
  }

  /* Better touch feedback */
  .btn:active {
    transform: scale(0.97);
  }
}

/* Safe area insets for notched devices */
@supports (padding: max(0px)) {
  .pb-safe {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .pt-safe {
    padding-top: max(1rem, env(safe-area-inset-top));
  }
}

/* Prevent text selection on buttons for better touch UX */
.btn {
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* ============================================
   Advanced Micro-interactions & Animations
   ============================================ */

/* Spring-based easing functions */
:root {
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
  --ease-elastic: cubic-bezier(0.68, -0.6, 0.32, 1.6);
}

/* Enhanced glassmorphism effect */
.glass-card-enhanced {
  @apply backdrop-blur-xl bg-base-100/60 border border-base-content/10;
  box-shadow:
    0 4px 6px -1px rgba(0, 0, 0, 0.1),
    0 2px 4px -1px rgba(0, 0, 0, 0.06),
    inset 0 1px 0 0 rgba(255, 255, 255, 0.05);
}

[data-theme="light"] .glass-card-enhanced {
  @apply bg-base-100/70;
  box-shadow:
    0 4px 6px -1px rgba(0, 0, 0, 0.05),
    0 2px 4px -1px rgba(0, 0, 0, 0.03),
    inset 0 1px 0 0 rgba(255, 255, 255, 0.8);
}

/* Ripple effect animation */
@keyframes ripple {
  0% {
    transform: scale(0);
    opacity: 0.6;
  }
  100% {
    transform: scale(4);
    opacity: 0;
  }
}

.ripple {
  position: absolute;
  border-radius: 50%;
  background-color: currentColor;
  pointer-events: none;
  animation: ripple 600ms var(--ease-smooth);
}

/* Subtle card hover effect - no scaling */
.card-hover-float {
  transition: background-color 200ms var(--ease-smooth);
}

/* Shimmer loading effect */
@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.shimmer {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.05) 50%,
    rgba(255, 255, 255, 0) 100%
  );
  background-size: 1000px 100%;
  animation: shimmer 2s infinite;
}

[data-theme="light"] .shimmer {
  background: linear-gradient(
    90deg,
    rgba(150, 107, 255, 0) 0%,
    rgba(150, 107, 255, 0.1) 50%,
    rgba(150, 107, 255, 0) 100%
  );
  background-size: 1000px 100%;
}

/* Bounce in animation */
@keyframes bounceIn {
  0% {
    opacity: 0;
    transform: scale(0.3);
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
  }
  70% {
    transform: scale(0.9);
  }
  100% {
    transform: scale(1);
  }
}

.animate-bounce-in {
  animation: bounceIn 0.5s var(--ease-spring);
}

/* Slide in from bottom */
@keyframes slideInBottom {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-in-bottom {
  animation: slideInBottom 0.4s var(--ease-smooth);
}

/* Glow pulse effect - Subtle version */
@keyframes glow-pulse {
  0%, 100% {
    box-shadow: 0 0 3px rgba(163, 116, 255, 0.2);
  }
  50% {
    box-shadow: 0 0 8px rgba(163, 116, 255, 0.35);
  }
}

.animate-glow-pulse {
  animation: glow-pulse 3s ease-in-out infinite;
}

/* Enhanced button hover effects */
.btn-primary, .btn-secondary, .btn-accent {
  position: relative;
  overflow: hidden;
  transition: all 200ms var(--ease-smooth);
}

.btn-primary:hover, .btn-secondary:hover, .btn-accent:hover {
  transform: translateY(-2px);
  box-shadow:
    0 10px 20px -5px rgba(163, 116, 255, 0.4),
    0 4px 8px -2px rgba(0, 0, 0, 0.1);
}

.btn-primary:active, .btn-secondary:active, .btn-accent:active {
  transform: translateY(0);
  box-shadow:
    0 4px 8px -2px rgba(163, 116, 255, 0.3),
    0 2px 4px -1px rgba(0, 0, 0, 0.08);
}

/* Enhanced focus ring with pulse */
:focus-visible {
  @apply outline-none;
  animation: focus-ring-pulse 0.3s var(--ease-smooth);
  box-shadow:
    0 0 0 3px var(--background),
    0 0 0 5px var(--accent-purple),
    0 0 20px rgba(163, 116, 255, 0.3);
}

@keyframes focus-ring-pulse {
  0% {
    box-shadow:
      0 0 0 0px var(--background),
      0 0 0 0px var(--accent-purple);
  }
  100% {
    box-shadow:
      0 0 0 3px var(--background),
      0 0 0 5px var(--accent-purple);
  }
}

/* Page transition animations */
@keyframes page-enter {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.page-enter {
  animation: page-enter 0.4s var(--ease-smooth);
}

/* Stagger animation helper */
.stagger-item {
  opacity: 0;
  animation: fadeIn 0.3s var(--ease-smooth) forwards;
}

.stagger-item:nth-child(1) { animation-delay: 0.02s; }
.stagger-item:nth-child(2) { animation-delay: 0.04s; }
.stagger-item:nth-child(3) { animation-delay: 0.06s; }
.stagger-item:nth-child(4) { animation-delay: 0.08s; }
.stagger-item:nth-child(5) { animation-delay: 0.1s; }
.stagger-item:nth-child(6) { animation-delay: 0.12s; }

/* Enhanced shadow utilities */
.shadow-soft {
  box-shadow:
    0 1px 4px -1px rgba(0, 0, 0, 0.06),
    0 1px 2px -1px rgba(0, 0, 0, 0.03);
}

.shadow-elevated {
  box-shadow:
    0 4px 12px -3px rgba(0, 0, 0, 0.08),
    0 2px 6px -2px rgba(0, 0, 0, 0.06);
}

.shadow-glow-purple {
  box-shadow:
    0 2px 8px rgba(163, 116, 255, 0.15),
    0 1px 3px rgba(163, 116, 255, 0.1);
}

.shadow-glow-pink {
  box-shadow:
    0 2px 8px rgba(179, 45, 182, 0.15),
    0 1px 3px rgba(179, 45, 182, 0.1);
}

/* Smooth gradient transitions */
.gradient-bg-animated {
  background: var(--accent-gradient);
  background-size: 200% 200%;
  animation: gradient-shift 6s ease infinite;
  transition: opacity 300ms var(--ease-smooth);
}

.gradient-bg-animated:hover {
  opacity: 0.9;
}

/* Enhanced chat bubble animations */
.chat-bubble-enter {
  animation: slideUp 0.3s var(--ease-spring);
}

/* Interactive link hover effect */
.link-hover-underline {
  position: relative;
  transition: color 200ms var(--ease-smooth);
}

.link-hover-underline::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 0;
  height: 2px;
  background: currentColor;
  transition: width 250ms var(--ease-smooth);
}

.link-hover-underline:hover::after {
  width: 100%;
}

/* Backdrop blur utilities */
.backdrop-blur-strong {
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
}

.backdrop-blur-medium {
  backdrop-filter: blur(12px) saturate(150%);
  -webkit-backdrop-filter: blur(12px) saturate(150%);
}

/* Smooth scroll behavior */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }

  * {
    scroll-padding-top: 2rem;
  }
}
