@tailwind base;
@tailwind components;
@tailwind utilities;

/* DXM Dark Theme (default) */
:root {
  --background: #130E26;
  --foreground: #C2CBE0;
  --accent-purple: #A374FF;
  --accent-pink: #B32DB6;
  --accent-gradient: linear-gradient(135deg, #B32DB6, #966BFF, #4B38A5);
}

/* NGO Light Theme */
[data-theme="light"] {
  --background: #FFF5FC;
  --foreground: #391E60;
  --accent-purple: #966BFF;
  --accent-pink: #FF9DFF;
  --accent-gradient: linear-gradient(172deg, #FF9DFF, #A398FF 45%, #7D66FF);
}

:root:has(.no-doc-scroll) {
  overflow: hidden;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: var(--font-sarasa-gothic), Arial, Helvetica, sans-serif;
}

/* Background with image */
.animated-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  background-image: url('https://angelkawaii.com/wp-content/uploads/2024/01/33.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

.animated-bg::after {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(19, 14, 38, 0.6);
}

[data-theme="light"] .animated-bg::after {
  background: rgba(255, 245, 252, 0.7);
}

/* Spinner animation */
@keyframes spinner {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin-slow {
  animation: spinner 6s linear infinite;
}

/* Glass effect */
.glass-card {
  @apply backdrop-blur-md bg-white/70 dark:bg-gray-900/70 border border-white/20 dark:border-gray-700/30;
}

/* Chat bubbles with tails */
.chat-bubble {
  max-width: 90%;
  overflow: visible !important;
  border: none !important;
}

/* User bubble (right) */
.chat-user {
  @apply bg-gradient-to-br from-primary to-secondary text-primary-content;
  border-radius: 1rem 1rem 0.25rem 1rem;
}
.chat-end .chat-bubble.chat-user::before {
  background-color: var(--accent-pink) !important;
}

/* Assistant bubbles (left) - shared styles */
.chat-assistant,
.chat-assistant-loading,
.chat-human-response {
  @apply text-base-content;
  border-radius: 1rem 1rem 1rem 0.25rem;
}

/* Assistant bubble */
.chat-assistant,
.chat-assistant-loading {
  background-color: rgba(163, 116, 255, 0.3) !important;
}
.chat-start .chat-bubble.chat-assistant::before,
.chat-start .chat-bubble.chat-assistant-loading::before {
  background-color: rgba(163, 116, 255, 0.3) !important;
}

/* Human response bubble (pink tint) */
.chat-human-response {
  background-color: rgba(179, 45, 182, 0.3) !important;
}
.chat-start .chat-bubble.chat-human-response::before {
  background-color: rgba(179, 45, 182, 0.3) !important;
}

/* Light theme overrides */
[data-theme="light"] .chat-assistant,
[data-theme="light"] .chat-assistant-loading {
  @apply bg-base-200;
}
[data-theme="light"] .chat-start .chat-bubble::before {
  background-color: #FCF9FF !important;
}

/* Typing animation - gradient pulse (Misskey-inspired) */
@keyframes typing-pulse {
  0%, 100% {
    transform: scale(0.8);
    opacity: 0.4;
  }
  50% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes gradient-shift {
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}

.typing-dot-gradient {
  @apply w-2 h-2 rounded-full;
  background: var(--accent-gradient);
  background-size: 200% 200%;
  animation: typing-pulse 1.2s infinite ease-in-out, gradient-shift 3s infinite ease-in-out;
}

.typing-dot-gradient:nth-child(1) {
  animation-delay: 0s, 0s;
}

.typing-dot-gradient:nth-child(2) {
  animation-delay: 0.15s, 0.5s;
}

.typing-dot-gradient:nth-child(3) {
  animation-delay: 0.3s, 1s;
}

/* Legacy typing dot */
.typing-dot {
  @apply w-1.5 h-1.5 rounded-full bg-primary;
  animation: typing-pulse 1.4s infinite ease-in-out;
}

.typing-dot:nth-child(1) {
  animation-delay: 0s;
}

.typing-dot:nth-child(2) {
  animation-delay: 0.15s;
}

/* Emotion indicator colors */
.emotion-happiness { @apply bg-yellow-400; }
.emotion-sadness { @apply bg-blue-400; }
.emotion-anxiety { @apply bg-purple-400; }
.emotion-anger { @apply bg-red-400; }
.emotion-loneliness { @apply bg-indigo-400; }
.emotion-depression { @apply bg-gray-600; }
.emotion-stress { @apply bg-orange-400; }
.emotion-confusion { @apply bg-teal-400; }
.emotion-hope { @apply bg-green-400; }
.emotion-neutral { @apply bg-gray-400; }

/* Fade in animation */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Slide up animation */
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slide-up {
  animation: slideUp 0.3s ease-out;
}

/* Scale in animation (for modals) */
@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-scale-in {
  animation: scaleIn 0.2s ease-out;
}

/* Slide in right animation (for toasts) */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-slide-in-right {
  animation: slideInRight 0.3s ease-out;
}

/* Dropdown animation */
@keyframes dropdownIn {
  from {
    opacity: 0;
    transform: translateY(-4px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.animate-dropdown-in {
  animation: dropdownIn 0.15s ease-out;
}

/* Pulse animation for skeletons */
@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.skeleton {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* Smooth transitions for interactive elements */
.btn {
  transition: background-color 150ms ease-in-out, color 150ms ease-in-out, transform 100ms ease-out, opacity 150ms ease-in-out;
}

.chat-bubble {
  transition: transform 150ms ease-out, opacity 150ms ease-out, box-shadow 200ms ease-out;
}

/* Smooth message entrance */
.chat {
  animation: slideUp 0.2s ease-out;
}

/* Hover effects */
.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0);
}

/* GitHub Corner (yamisskey-down style) */
.github-corner:hover .octo-arm {
  animation: octocat-wave 560ms ease-in-out;
}

@keyframes octocat-wave {
  0%, 100% { transform: rotate(0); }
  20%, 60% { transform: rotate(-25deg); }
  40%, 80% { transform: rotate(10deg); }
}

@media (max-width: 500px) {
  .github-corner:hover .octo-arm {
    animation: none;
  }
  .github-corner .octo-arm {
    animation: octocat-wave 560ms ease-in-out;
  }
}

/* ============================================
   Accessibility Improvements
   ============================================ */

/* Enhanced focus ring for better visibility */
:focus-visible {
  @apply outline-none ring-2 ring-primary ring-offset-2 ring-offset-base-100;
}

/* Skip link for keyboard users */
.skip-link {
  @apply sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-content focus:rounded-lg;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ============================================
   Mobile UX Improvements
   ============================================ */

/* Ensure minimum tap target size (44px) */
@media (max-width: 768px) {
  .btn-xs {
    min-height: 2.5rem;
    min-width: 2.5rem;
  }

  /* Better touch feedback */
  .btn:active {
    transform: scale(0.97);
  }
}

/* Safe area insets for notched devices */
@supports (padding: max(0px)) {
  .pb-safe {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .pt-safe {
    padding-top: max(1rem, env(safe-area-inset-top));
  }
}

/* Prevent text selection on buttons for better touch UX */
.btn {
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}
